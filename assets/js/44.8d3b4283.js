(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{400:function(s,_,a){"use strict";a.r(_);var t=a(8),v=Object(t.a)({},(function(){var s=this,_=s._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[_("p",[s._v("在Java中，"),_("code",[s._v("String")]),s._v("是使用最频繁的引用类型之一，其设计与JVM的字符串常量池（String Table）密切相关。字符串常量池作为JVM对字符串的核心优化机制，通过复用相同字符串对象大幅减少内存占用，同时保障了字符串操作的高效性。本文将从"),_("code",[s._v("String")]),s._v("的本质特性出发，深入剖析字符串常量池的存储机制、运行流程及实践中的优化策略。")]),s._v(" "),_("h2",{attrs:{id:"一、string的核心特性-不可变性"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#一、string的核心特性-不可变性"}},[s._v("#")]),s._v(" 一、String的核心特性：不可变性")]),s._v(" "),_("p",[_("code",[s._v("String")]),s._v("的不可变性是JVM设计字符串常量池的基础，其核心表现与实现逻辑如下：")]),s._v(" "),_("h3",{attrs:{id:"_1-1-底层存储的不可变设计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-底层存储的不可变设计"}},[s._v("#")]),s._v(" 1.1 底层存储的不可变设计")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("JDK版本差异")]),s._v("："),_("br"),s._v("\nJDK 8及之前，"),_("code",[s._v("String")]),s._v("底层通过"),_("code",[s._v("private final char[] value")]),s._v("存储字符（每个字符占2字节）；"),_("br"),s._v("\nJDK 9及之后，改为"),_("code",[s._v("private final byte[] value")]),s._v("（默认使用Latin-1编码，单字节存储普通字符，节省50%内存）。")]),s._v(" "),_("li",[_("strong",[s._v("不可变的保障")]),s._v("："),_("br"),s._v(" "),_("code",[s._v("value")]),s._v("数组被"),_("code",[s._v("final")]),s._v("修饰，确保引用不可变；且"),_("code",[s._v("String")]),s._v("类未提供任何修改数组元素的方法（如"),_("code",[s._v("setCharAt")]),s._v("），外部无法直接修改底层数据。")])]),s._v(" "),_("h3",{attrs:{id:"_1-2-字符串修改的本质"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-字符串修改的本质"}},[s._v("#")]),s._v(" 1.2 字符串修改的本质")]),s._v(" "),_("p",[s._v("任何对"),_("code",[s._v("String")]),s._v('的"修改"操作（如'),_("code",[s._v("substring")]),s._v("、"),_("code",[s._v("replace")]),s._v("、"),_("code",[s._v("concat")]),s._v("）都会创建新的"),_("code",[s._v("String")]),s._v("实例，原对象保持不变。例如：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('String s = "abc";\ns = s.concat("d"); // 原"abc"对象未变，创建新对象"abcd"并赋值给s\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br")])]),_("h3",{attrs:{id:"_1-3-不可变性的优势"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-不可变性的优势"}},[s._v("#")]),s._v(" 1.3 不可变性的优势")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("线程安全")]),s._v("：多线程并发访问时，无需额外同步机制，避免数据冲突；")]),s._v(" "),_("li",[_("strong",[s._v("常量池复用")]),s._v("：相同字符串可共享同一实例，减少内存消耗；")]),s._v(" "),_("li",[_("strong",[s._v("哈希缓存")]),s._v("："),_("code",[s._v("hashCode()")]),s._v("计算后会缓存到"),_("code",[s._v("hash")]),s._v("字段，避免重复计算（适合作为"),_("code",[s._v("HashMap")]),s._v("的键）。")])]),s._v(" "),_("h2",{attrs:{id:"二、jvm中string的存储模型"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#二、jvm中string的存储模型"}},[s._v("#")]),s._v(" 二、JVM中String的存储模型")]),s._v(" "),_("p",[s._v("JVM对字符串的存储涉及"),_("strong",[s._v("运行时常量池")]),s._v("和"),_("strong",[s._v("字符串常量池（String Table）")]),s._v(" 两个核心结构，二者分工明确又紧密协作。")]),s._v(" "),_("h3",{attrs:{id:"_2-1-存储位置的版本演变"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-存储位置的版本演变"}},[s._v("#")]),s._v(" 2.1 存储位置的版本演变")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("JDK 6及之前")]),s._v("：字符串常量池位于"),_("strong",[s._v("永久代（PermGen）")]),s._v("，运行时常量池作为方法区的一部分也在永久代；")]),s._v(" "),_("li",[_("strong",[s._v("JDK 7及之后")]),s._v("：字符串常量池迁移至"),_("strong",[s._v("堆内存")]),s._v("，运行时常量池仍属于方法区（JDK 8后方法区以元空间Metaspace实现，存储类元信息）。")])]),s._v(" "),_("h3",{attrs:{id:"_2-2-核心存储结构解析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-核心存储结构解析"}},[s._v("#")]),s._v(" 2.2 核心存储结构解析")]),s._v(" "),_("table",[_("thead",[_("tr",[_("th",[s._v("结构")]),s._v(" "),_("th",[s._v("位置")]),s._v(" "),_("th",[s._v("作用")]),s._v(" "),_("th",[s._v("特性")])])]),s._v(" "),_("tbody",[_("tr",[_("td",[s._v("运行时常量池")]),s._v(" "),_("td",[s._v("元空间（方法区）")]),s._v(" "),_("td",[s._v("存储类的常量信息（包括字符串字面量、数字常量、符号引用等）")]),s._v(" "),_("td",[s._v("每个类独有，随类加载创建")])]),s._v(" "),_("tr",[_("td",[s._v("字符串常量池（String Table）")]),s._v(" "),_("td",[s._v("堆内存")]),s._v(" "),_("td",[s._v("全局哈希表，存储字符串对象的引用，实现字符串实例的全局复用")]),s._v(" "),_("td",[s._v("所有类共享，懒加载创建")])]),s._v(" "),_("tr",[_("td",[s._v("堆内存（普通对象）")]),s._v(" "),_("td",[s._v("堆内存")]),s._v(" "),_("td",[s._v("存储通过"),_("code",[s._v("new")]),s._v("创建的字符串对象（未入池或未被常量池引用的实例）")]),s._v(" "),_("td",[s._v("无复用，随GC回收")])])])]),s._v(" "),_("h3",{attrs:{id:"_2-3-结构间的关联逻辑"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-结构间的关联逻辑"}},[s._v("#")]),s._v(" 2.3 结构间的关联逻辑")]),s._v(" "),_("ol",[_("li",[s._v("类加载时，"),_("code",[s._v(".class")]),s._v("文件中的编译时常量池（含字符串字面量）被加载到元空间的"),_("strong",[s._v("运行时常量池")]),s._v("；")]),s._v(" "),_("li",[s._v("运行时首次使用字符串字面量时，JVM会通过运行时常量池的字面量去"),_("strong",[s._v("字符串常量池")]),s._v("查找对应实例；")]),s._v(" "),_("li",[s._v("若找到则复用，否则在堆中创建实例并将引用存入字符串常量池，同时更新运行时常量池的字面量为实例引用。")])]),s._v(" "),_("h2",{attrs:{id:"三、字符串的生命周期-从编译到运行"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#三、字符串的生命周期-从编译到运行"}},[s._v("#")]),s._v(" 三、字符串的生命周期：从编译到运行")]),s._v(" "),_("p",[s._v("字符串从代码编写到实际使用，经历"),_("strong",[s._v("编译→类加载→运行时解析")]),s._v("三个阶段，每个阶段的JVM操作如下：")]),s._v(" "),_("h3",{attrs:{id:"_3-1-编译阶段-记录字面量"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-编译阶段-记录字面量"}},[s._v("#")]),s._v(" 3.1 编译阶段：记录字面量")]),s._v(" "),_("p",[s._v("当代码中出现"),_("code",[s._v('String s = "abc"')]),s._v("时：")]),s._v(" "),_("ul",[_("li",[s._v("编译器在"),_("code",[s._v(".class")]),s._v("文件的"),_("strong",[s._v("编译时常量池")]),s._v("中记录字面量"),_("code",[s._v('"abc"')]),s._v("（仅文本信息，无对象实例）；")]),s._v(" "),_("li",[s._v("生成字节码指令"),_("code",[s._v('ldc "abc"')]),s._v("，表示运行时需从当前类的运行时常量池加载该字符串。")])]),s._v(" "),_("h3",{attrs:{id:"_3-2-类加载阶段-加载常量到运行时常量池"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-类加载阶段-加载常量到运行时常量池"}},[s._v("#")]),s._v(" 3.2 类加载阶段：加载常量到运行时常量池")]),s._v(" "),_("p",[s._v("JVM加载类时：")]),s._v(" "),_("ul",[_("li",[s._v("将"),_("code",[s._v(".class")]),s._v("文件的编译时常量池加载到元空间，生成当前类的"),_("strong",[s._v("运行时常量池")]),s._v("；")]),s._v(" "),_("li",[s._v("字面量"),_("code",[s._v('"abc"')]),s._v("被存入运行时常量池（仍为文本记录，未关联对象实例）。")])]),s._v(" "),_("h3",{attrs:{id:"_3-3-运行时解析阶段-创建实例并关联常量池"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-运行时解析阶段-创建实例并关联常量池"}},[s._v("#")]),s._v(" 3.3 运行时解析阶段：创建实例并关联常量池")]),s._v(" "),_("p",[s._v("当JVM执行"),_("code",[s._v('String s = "abc"')]),s._v("时（首次使用该字面量）：")]),s._v(" "),_("ol",[_("li",[s._v("检查运行时常量池，发现"),_("code",[s._v('"abc"')]),s._v("仍是文本记录（未关联对象）；")]),s._v(" "),_("li",[s._v("去"),_("strong",[s._v("字符串常量池")]),s._v("查找是否有"),_("code",[s._v('"abc"')]),s._v("的引用：\n"),_("ul",[_("li",[s._v("若存在，直接获取引用（如"),_("code",[s._v("0x666")]),s._v("）；")]),s._v(" "),_("li",[s._v("若不存在，在堆中创建"),_("code",[s._v('"abc"')]),s._v("对象（地址"),_("code",[s._v("0x666")]),s._v("），并将引用存入字符串常量池；")])])]),s._v(" "),_("li",[s._v("更新运行时常量池的"),_("code",[s._v('"abc"')]),s._v("文本记录为引用"),_("code",[s._v("0x666")]),s._v("（完成符号引用→直接引用的解析）；")]),s._v(" "),_("li",[s._v("将引用"),_("code",[s._v("0x666")]),s._v("赋值给栈中变量"),_("code",[s._v("s")]),s._v("。")])]),s._v(" "),_("p",[_("strong",[s._v("阶段交互图示")]),s._v("：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('┌─────────────────┐    编译    ┌─────────────────┐\n│ 源代码          │ ─────────> │ .class文件      │\n│ String s = "abc"│            │ 编译时常量池    │\n│                 │            │ （"abc"字面量） │\n└─────────────────┘            └────────┬────────┘\n                                         │ 类加载\n                                         ▼\n┌─────────────────┐    解析后关联    ┌─────────────────┐\n│ 虚拟机栈        │ <───────────── │ 元空间（方法区） │\n│ 变量s（引用0x666）│               │ 运行时常量池    │\n└─────────────────┘               │ （"abc"→0x666）  │\n                                         │ 引用\n                                         ▼\n                              ┌─────────────────┐\n                              │ 堆内存          │\n                              │ 字符串常量池    │\n                              │ （存储0x666引用）│\n                              │ "abc"对象（0x666）│\n                              └─────────────────┘\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br"),_("span",{staticClass:"line-number"},[s._v("6")]),_("br"),_("span",{staticClass:"line-number"},[s._v("7")]),_("br"),_("span",{staticClass:"line-number"},[s._v("8")]),_("br"),_("span",{staticClass:"line-number"},[s._v("9")]),_("br"),_("span",{staticClass:"line-number"},[s._v("10")]),_("br"),_("span",{staticClass:"line-number"},[s._v("11")]),_("br"),_("span",{staticClass:"line-number"},[s._v("12")]),_("br"),_("span",{staticClass:"line-number"},[s._v("13")]),_("br"),_("span",{staticClass:"line-number"},[s._v("14")]),_("br"),_("span",{staticClass:"line-number"},[s._v("15")]),_("br"),_("span",{staticClass:"line-number"},[s._v("16")]),_("br"),_("span",{staticClass:"line-number"},[s._v("17")]),_("br"),_("span",{staticClass:"line-number"},[s._v("18")]),_("br"),_("span",{staticClass:"line-number"},[s._v("19")]),_("br")])]),_("h2",{attrs:{id:"四、string的创建方式与常量池交互"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#四、string的创建方式与常量池交互"}},[s._v("#")]),s._v(" 四、String的创建方式与常量池交互")]),s._v(" "),_("p",[s._v("不同创建方式会导致字符串与常量池的交互逻辑不同，直接影响对象复用和内存占用。")]),s._v(" "),_("h3",{attrs:{id:"_4-1-字面量赋值-string-s-abc"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-字面量赋值-string-s-abc"}},[s._v("#")]),s._v(" 4.1 字面量赋值："),_("code",[s._v('String s = "abc"')])]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("流程")]),s._v("：优先从字符串常量池查找，不存在则创建对象并入池，复用已有引用；")]),s._v(" "),_("li",[_("strong",[s._v("特点")]),s._v("：可能复用常量池中的实例，减少对象创建；")]),s._v(" "),_("li",[_("strong",[s._v("示例")]),s._v("：")])]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('  String s1 = "abc"; \n  String s2 = "abc"; \n  s1 == s2; // true（复用同一实例，地址相同）\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br")])]),_("h3",{attrs:{id:"_4-2-new-string-abc-强制创建新对象"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-new-string-abc-强制创建新对象"}},[s._v("#")]),s._v(" 4.2 "),_("code",[s._v('new String("abc")')]),s._v("：强制创建新对象")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("流程")]),s._v("：\n"),_("ol",[_("li",[s._v("检查字符串常量池，若"),_("code",[s._v('"abc"')]),s._v("不存在则创建并入池（地址"),_("code",[s._v("0x666")]),s._v("）；")]),s._v(" "),_("li",[s._v("在堆中"),_("strong",[s._v("新创建一个"),_("code",[s._v("String")]),s._v("对象")]),s._v("（地址"),_("code",[s._v("0x777")]),s._v("），复制"),_("code",[s._v("0x666")]),s._v("的数据；")]),s._v(" "),_("li",[s._v("变量引用"),_("code",[s._v("0x777")]),s._v("（与常量池实例无关）；")])])]),s._v(" "),_("li",[_("strong",[s._v("特点")]),s._v("：至少创建1个对象（若常量池已有则仅1个，否则2个）；")]),s._v(" "),_("li",[_("strong",[s._v("示例")]),s._v("：")])]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('  String s1 = new String("abc"); \n  String s2 = "abc"; \n  s1 == s2; // false（s1指向堆新对象，s2指向常量池引用）\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br")])]),_("h3",{attrs:{id:"_4-3-字符串拼接-new-string-a-new-string-b"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-字符串拼接-new-string-a-new-string-b"}},[s._v("#")]),s._v(" 4.3 字符串拼接："),_("code",[s._v('new String("a") + new String("b")')])]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("流程")]),s._v("：\n"),_("ol",[_("li",[s._v("编译时会被优化为"),_("code",[s._v('new StringBuilder().append("a").append("b").toString()')]),s._v("；")]),s._v(" "),_("li",[_("code",[s._v("toString()")]),s._v("方法会创建新"),_("code",[s._v("String")]),s._v("对象"),_("code",[s._v('"ab"')]),s._v("（地址"),_("code",[s._v("0x888")]),s._v("），但"),_("strong",[s._v("不会自动入池")]),s._v("；")])])]),s._v(" "),_("li",[_("strong",[s._v("特点")]),s._v("：创建多个临时对象（"),_("code",[s._v('"a"')]),s._v("、"),_("code",[s._v('"b"')]),s._v("、"),_("code",[s._v("StringBuilder")]),s._v("、"),_("code",[s._v('"ab"')]),s._v("）；")]),s._v(" "),_("li",[_("strong",[s._v("示例")]),s._v("：")])]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('  String s1 = new String("a") + new String("b"); \n  String s2 = "ab"; \n  s1 == s2; // false（s1的"ab"未入池）\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br")])]),_("h3",{attrs:{id:"_4-4-非字面量创建-new-string-char"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-非字面量创建-new-string-char"}},[s._v("#")]),s._v(" 4.4 非字面量创建："),_("code",[s._v("new String(char[])")])]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("流程")]),s._v("：直接在堆中创建字符串对象，"),_("strong",[s._v("与字符串常量池无交互")]),s._v("（不会自动入池）；")]),s._v(" "),_("li",[_("strong",[s._v("示例")]),s._v("：")])]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("  String s1 = new String(new char[]{'a','b','c'}); \n  String s2 = \"abc\"; \n  s1 == s2; // false（s1未入池，s2指向池内引用）\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br")])]),_("h3",{attrs:{id:"_4-5-intern-手动入池与引用获取"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-intern-手动入池与引用获取"}},[s._v("#")]),s._v(" 4.5 "),_("code",[s._v("intern()")]),s._v("：手动入池与引用获取")]),s._v(" "),_("p",[_("code",[s._v("intern()")]),s._v("方法将当前字符串对象的引用存入字符串常量池，并返回常量池中的引用（JDK 7+特性）。")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("场景1：常量池已有目标字符串")])])]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('  String s1 = new String("abc"); // 常量池已有"abc"（0x666），s1指向新对象（0x777）\n  String s2 = s1.intern(); // 返回常量池引用0x666\n  s1 == s2; // false（0x777 ≠ 0x666）\n  s2 == "abc"; // true（均为0x666）\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br")])]),_("ul",[_("li",[_("strong",[s._v("场景2：常量池无目标字符串")])])]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("  String s3 = new String(new char[]{'a','b','c'}); // s3指向0x888（未入池）\n  String s4 = s3.intern(); // 将0x888存入常量池，返回0x888\n  s3 == s4; // true（均为0x888）\n  s3 == \"abc\"; // true（\"abc\"从常量池取0x888）\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br")])]),_("ul",[_("li",[_("strong",[s._v("JDK版本差异")]),s._v("："),_("br"),s._v("\nJDK 6中"),_("code",[s._v("intern()")]),s._v("会复制字符串到永久代的常量池，返回新引用；JDK 7+直接存储堆中对象的引用，避免复制，更高效。")])]),s._v(" "),_("h2",{attrs:{id:"五、string常量池的性能优化实践"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#五、string常量池的性能优化实践"}},[s._v("#")]),s._v(" 五、String常量池的性能优化实践")]),s._v(" "),_("p",[s._v("合理利用字符串常量池可显著减少内存占用和GC压力，关键优化策略如下：")]),s._v(" "),_("h3",{attrs:{id:"_5-1-避免频繁字符串拼接"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-避免频繁字符串拼接"}},[s._v("#")]),s._v(" 5.1 避免频繁字符串拼接")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("问题")]),s._v("："),_("code",[s._v("+")]),s._v("拼接会编译为"),_("code",[s._v("StringBuilder")]),s._v("操作，频繁拼接（如循环中）会创建大量临时对象；")]),s._v(" "),_("li",[_("strong",[s._v("优化")]),s._v("：直接使用"),_("code",[s._v("StringBuilder")]),s._v("并指定初始容量（默认16，扩容会复制数组）：")])]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("  // 推荐\n  StringBuilder sb = new StringBuilder(1024); // 预设足够容量\n  for (int i = 0; i < 1000; i++) {\n      sb.append(i);\n  }\n  String result = sb.toString();\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br"),_("span",{staticClass:"line-number"},[s._v("6")]),_("br")])]),_("h3",{attrs:{id:"_5-2-合理使用intern"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-合理使用intern"}},[s._v("#")]),s._v(" 5.2 合理使用"),_("code",[s._v("intern()")])]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("适用场景")]),s._v("：高频重复字符串（如日志关键词、字典词），通过"),_("code",[s._v("intern()")]),s._v("入池复用；")]),s._v(" "),_("li",[_("strong",[s._v("注意")]),s._v("：低频字符串入池会浪费常量池空间（常量池对象生命周期长，不易回收）。")])]),s._v(" "),_("h3",{attrs:{id:"_5-3-空字符串检查优化"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-空字符串检查优化"}},[s._v("#")]),s._v(" 5.3 空字符串检查优化")]),s._v(" "),_("ul",[_("li",[s._v("用"),_("code",[s._v("str.isEmpty()")]),s._v("代替"),_("code",[s._v('"".equals(str)')]),s._v("，避免创建临时空字符串对象；")]),s._v(" "),_("li",[s._v("用"),_("code",[s._v('Objects.equals(str, "")')]),s._v("处理"),_("code",[s._v("str")]),s._v("为"),_("code",[s._v("null")]),s._v("的场景，更安全高效。")])]),s._v(" "),_("h3",{attrs:{id:"_5-4-调整常量池参数"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-调整常量池参数"}},[s._v("#")]),s._v(" 5.4 调整常量池参数")]),s._v(" "),_("p",[s._v("通过JVM参数"),_("code",[s._v("-XX:StringTableSize")]),s._v("调整字符串常量池的哈希表大小（默认值：JDK 11+为65536），减少哈希冲突，提升查找效率（适用于字符串数量极多的场景）。")]),s._v(" "),_("h2",{attrs:{id:"六、总结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#六、总结"}},[s._v("#")]),s._v(" 六、总结")]),s._v(" "),_("p",[s._v("字符串常量池是JVM对"),_("code",[s._v("String")]),s._v("类型的核心优化，其本质是全局哈希表，通过复用相同字符串实例减少内存消耗。")])])}),[],!1,null,null,null);_.default=v.exports}}]);