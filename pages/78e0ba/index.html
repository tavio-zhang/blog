<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES ILM | Tavio&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/logo.jpg">
    <meta name="description" content="后端技术博客,别让自己落后于技术的迭代">
    <meta name="keywords" content="鲜衣努码少年郎">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.3d594d45.css" as="style"><link rel="preload" href="/assets/js/app.c6ba13aa.js" as="script"><link rel="preload" href="/assets/js/2.8d9f533d.js" as="script"><link rel="preload" href="/assets/js/42.575e5238.js" as="script"><link rel="prefetch" href="/assets/js/10.3c6e6522.js"><link rel="prefetch" href="/assets/js/11.09bc43b4.js"><link rel="prefetch" href="/assets/js/12.a996a87c.js"><link rel="prefetch" href="/assets/js/13.b02d3acf.js"><link rel="prefetch" href="/assets/js/14.64fd6e84.js"><link rel="prefetch" href="/assets/js/15.089c02a9.js"><link rel="prefetch" href="/assets/js/16.8fa236f4.js"><link rel="prefetch" href="/assets/js/17.a1730b7a.js"><link rel="prefetch" href="/assets/js/18.1335a425.js"><link rel="prefetch" href="/assets/js/19.9293cbc0.js"><link rel="prefetch" href="/assets/js/20.5d0fd1df.js"><link rel="prefetch" href="/assets/js/21.4319dddd.js"><link rel="prefetch" href="/assets/js/22.2d6d1193.js"><link rel="prefetch" href="/assets/js/23.f154e330.js"><link rel="prefetch" href="/assets/js/24.66ba0133.js"><link rel="prefetch" href="/assets/js/25.5979047a.js"><link rel="prefetch" href="/assets/js/26.04889c33.js"><link rel="prefetch" href="/assets/js/27.337928e8.js"><link rel="prefetch" href="/assets/js/28.665066df.js"><link rel="prefetch" href="/assets/js/29.5aa838b8.js"><link rel="prefetch" href="/assets/js/3.1aac6e80.js"><link rel="prefetch" href="/assets/js/30.a8923cf6.js"><link rel="prefetch" href="/assets/js/31.a290d548.js"><link rel="prefetch" href="/assets/js/32.cb2b7fdd.js"><link rel="prefetch" href="/assets/js/33.3286dca2.js"><link rel="prefetch" href="/assets/js/34.9aebb473.js"><link rel="prefetch" href="/assets/js/35.5777ff14.js"><link rel="prefetch" href="/assets/js/36.5c29dd6e.js"><link rel="prefetch" href="/assets/js/37.cbf6fde7.js"><link rel="prefetch" href="/assets/js/38.2a1572ab.js"><link rel="prefetch" href="/assets/js/39.000aacf6.js"><link rel="prefetch" href="/assets/js/4.16da1e3f.js"><link rel="prefetch" href="/assets/js/40.8fbbcfa8.js"><link rel="prefetch" href="/assets/js/41.1b995757.js"><link rel="prefetch" href="/assets/js/43.0a4cb54f.js"><link rel="prefetch" href="/assets/js/44.8d3b4283.js"><link rel="prefetch" href="/assets/js/45.ae001bba.js"><link rel="prefetch" href="/assets/js/46.fc29dcb1.js"><link rel="prefetch" href="/assets/js/47.628ee1ef.js"><link rel="prefetch" href="/assets/js/48.7d4f854a.js"><link rel="prefetch" href="/assets/js/49.e848253a.js"><link rel="prefetch" href="/assets/js/5.20e9c2cf.js"><link rel="prefetch" href="/assets/js/50.045225be.js"><link rel="prefetch" href="/assets/js/51.d05a2035.js"><link rel="prefetch" href="/assets/js/52.35a2519d.js"><link rel="prefetch" href="/assets/js/53.ca8d5bc8.js"><link rel="prefetch" href="/assets/js/54.eb93e6ae.js"><link rel="prefetch" href="/assets/js/55.27ff3cca.js"><link rel="prefetch" href="/assets/js/56.4a98635a.js"><link rel="prefetch" href="/assets/js/57.db243c6d.js"><link rel="prefetch" href="/assets/js/58.650ffef2.js"><link rel="prefetch" href="/assets/js/59.9af578d0.js"><link rel="prefetch" href="/assets/js/6.cf5ce51d.js"><link rel="prefetch" href="/assets/js/60.800afb74.js"><link rel="prefetch" href="/assets/js/61.59b23cca.js"><link rel="prefetch" href="/assets/js/62.35998712.js"><link rel="prefetch" href="/assets/js/63.824df362.js"><link rel="prefetch" href="/assets/js/64.2f51e9d0.js"><link rel="prefetch" href="/assets/js/65.926e2499.js"><link rel="prefetch" href="/assets/js/66.2af85da2.js"><link rel="prefetch" href="/assets/js/67.bbd8d4b3.js"><link rel="prefetch" href="/assets/js/68.163c774f.js"><link rel="prefetch" href="/assets/js/69.deed8d29.js"><link rel="prefetch" href="/assets/js/7.92776da2.js"><link rel="prefetch" href="/assets/js/70.d6a81068.js"><link rel="prefetch" href="/assets/js/71.9adb8c50.js"><link rel="prefetch" href="/assets/js/72.9ba26fc5.js"><link rel="prefetch" href="/assets/js/73.c3ee5d2f.js"><link rel="prefetch" href="/assets/js/74.af7973c7.js"><link rel="prefetch" href="/assets/js/75.ed8e7990.js"><link rel="prefetch" href="/assets/js/76.668519a5.js"><link rel="prefetch" href="/assets/js/77.d6cb2694.js"><link rel="prefetch" href="/assets/js/78.494cff39.js"><link rel="prefetch" href="/assets/js/79.486534af.js"><link rel="prefetch" href="/assets/js/8.d7fc67a9.js"><link rel="prefetch" href="/assets/js/80.c60f84eb.js"><link rel="prefetch" href="/assets/js/81.80ab610c.js"><link rel="prefetch" href="/assets/js/82.38a483d0.js"><link rel="prefetch" href="/assets/js/83.72b7d6a4.js"><link rel="prefetch" href="/assets/js/84.f5a347be.js"><link rel="prefetch" href="/assets/js/85.f3b7b32b.js"><link rel="prefetch" href="/assets/js/86.1d47bd30.js"><link rel="prefetch" href="/assets/js/87.2361eddb.js"><link rel="prefetch" href="/assets/js/88.aef9e475.js"><link rel="prefetch" href="/assets/js/89.0a95e3be.js"><link rel="prefetch" href="/assets/js/9.f6c9df9a.js"><link rel="prefetch" href="/assets/js/90.ddf7b632.js"><link rel="prefetch" href="/assets/js/91.2a96bacf.js"><link rel="prefetch" href="/assets/js/92.f61fc5ec.js"><link rel="prefetch" href="/assets/js/93.40a17799.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3d594d45.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="Tavio's blog" class="logo"> <span class="site-name can-hide">Tavio's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/jvm/" class="nav-link">JVM底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/thread/" class="nav-link">邪恶多线程</a></li><li class="dropdown-item"><!----> <a href="/node/mybatis/" class="nav-link">MyBatis底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/spring/" class="nav-link">Spring底层原理</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/db/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/mysql/" class="nav-link">MySQL的优化之路</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">ClickHouse的高性能</a></li><li class="dropdown-item"><!----> <a href="/note/redis/" class="nav-link">Redis的快速查询</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/middleware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/rabbitmq/" class="nav-link">RabbitMQ的生产</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">Kafka的高吞吐量</a></li><li class="dropdown-item"><!----> <a href="/note/es/" class="nav-link">ES的入门到入坑</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实践" class="dropdown-title"><a href="/practice/" class="link-title">实践</a> <span class="title" style="display:none;">实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/284351/" class="nav-link">MySQL自增ID主键空洞</a></li><li class="dropdown-item"><!----> <a href="/pages/8f1df0/" class="nav-link">前端实现长整型排序</a></li><li class="dropdown-item"><!----> <a href="/pages/13fcc3/" class="nav-link">MySQL无感换表</a></li><li class="dropdown-item"><!----> <a href="/pages/69e163/" class="nav-link">Redis延时双删</a></li><li class="dropdown-item"><!----> <a href="/pages/f43494/" class="nav-link">高并发秒杀优惠卷</a></li><li class="dropdown-item"><!----> <a href="/pages/ab9a49/" class="nav-link">AOP无侵入式告警</a></li><li class="dropdown-item"><!----> <a href="/pages/a3f3fd/" class="nav-link">长短链接跳转</a></li><li class="dropdown-item"><!----> <a href="/pages/942d4b/" class="nav-link">订单超时取消</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/tavio-zhang/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.jpg"> <div class="blogger-info"><h3>Tavio Zhang</h3> <span>努力学习的小码喽</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/jvm/" class="nav-link">JVM底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/thread/" class="nav-link">邪恶多线程</a></li><li class="dropdown-item"><!----> <a href="/node/mybatis/" class="nav-link">MyBatis底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/spring/" class="nav-link">Spring底层原理</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/db/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/mysql/" class="nav-link">MySQL的优化之路</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">ClickHouse的高性能</a></li><li class="dropdown-item"><!----> <a href="/note/redis/" class="nav-link">Redis的快速查询</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/middleware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/rabbitmq/" class="nav-link">RabbitMQ的生产</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">Kafka的高吞吐量</a></li><li class="dropdown-item"><!----> <a href="/note/es/" class="nav-link">ES的入门到入坑</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实践" class="dropdown-title"><a href="/practice/" class="link-title">实践</a> <span class="title" style="display:none;">实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/284351/" class="nav-link">MySQL自增ID主键空洞</a></li><li class="dropdown-item"><!----> <a href="/pages/8f1df0/" class="nav-link">前端实现长整型排序</a></li><li class="dropdown-item"><!----> <a href="/pages/13fcc3/" class="nav-link">MySQL无感换表</a></li><li class="dropdown-item"><!----> <a href="/pages/69e163/" class="nav-link">Redis延时双删</a></li><li class="dropdown-item"><!----> <a href="/pages/f43494/" class="nav-link">高并发秒杀优惠卷</a></li><li class="dropdown-item"><!----> <a href="/pages/ab9a49/" class="nav-link">AOP无侵入式告警</a></li><li class="dropdown-item"><!----> <a href="/pages/a3f3fd/" class="nav-link">长短链接跳转</a></li><li class="dropdown-item"><!----> <a href="/pages/942d4b/" class="nav-link">订单超时取消</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/tavio-zhang/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/4a1e64/" class="sidebar-link">ES CRUD</a></li><li><a href="/pages/5113b6/" class="sidebar-link">ES分布式架构</a></li><li><a href="/pages/0ed63c/" class="sidebar-link">ES ISR机制</a></li><li><a href="/pages/bdd874/" class="sidebar-link">ES深度分页查询优化</a></li><li><a href="/pages/9f755f/" class="sidebar-link">ES数据写入到查询</a></li><li><a href="/pages/af50b1/" class="sidebar-link">ELK的底层逻辑</a></li><li><a href="/pages/78e0ba/" aria-current="page" class="active sidebar-link">ES ILM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/78e0ba/#一、什么是ilm" class="sidebar-link">一、什么是ILM？</a></li><li class="sidebar-sub-header level2"><a href="/pages/78e0ba/#二、ilm生命周期阶段详解" class="sidebar-link">二、ILM生命周期阶段详解</a></li><li class="sidebar-sub-header level2"><a href="/pages/78e0ba/#三、ilm策略-定义索引的-生命周期规则" class="sidebar-link">三、ILM策略：定义索引的&quot;生命周期规则&quot;</a></li><li class="sidebar-sub-header level2"><a href="/pages/78e0ba/#四、实战-配置日志索引的ilm全流程" class="sidebar-link">四、实战：配置日志索引的ILM全流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/78e0ba/#步骤1-创建ilm策略" class="sidebar-link">步骤1：创建ILM策略</a></li><li class="sidebar-sub-header level3"><a href="/pages/78e0ba/#步骤2-创建索引模板-关联ilm策略" class="sidebar-link">步骤2：创建索引模板，关联ILM策略</a></li><li class="sidebar-sub-header level3"><a href="/pages/78e0ba/#步骤3-初始化索引并绑定滚动别名" class="sidebar-link">步骤3：初始化索引并绑定滚动别名</a></li><li class="sidebar-sub-header level3"><a href="/pages/78e0ba/#步骤4-调整ilm扫描频率-可选" class="sidebar-link">步骤4：调整ILM扫描频率（可选）</a></li><li class="sidebar-sub-header level3"><a href="/pages/78e0ba/#步骤5-验证ilm配置" class="sidebar-link">步骤5：验证ILM配置</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/78e0ba/#五、ilm执行机制与注意事项" class="sidebar-link">五、ILM执行机制与注意事项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/78e0ba/#执行流程" class="sidebar-link">执行流程</a></li><li class="sidebar-sub-header level3"><a href="/pages/78e0ba/#注意事项" class="sidebar-link">注意事项</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/78e0ba/#六、常见问题排查" class="sidebar-link">六、常见问题排查</a></li><li class="sidebar-sub-header level2"><a href="/pages/78e0ba/#总结" class="sidebar-link">总结</a></li></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/note/es/#《Elasticsearch》笔记" data-v-06225672>《Elasticsearch》笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/tavio-zhang" target="_blank" title="作者" class="beLink" data-v-06225672>Tavio</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2025-07-10</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">ES ILM<!----></h1>  <div class="theme-vdoing-content content__default"><p>在 Elasticsearch的日常运维中，日志、监控数据等时序数据会持续写入，导致索引数量和存储占用急剧膨胀。如果依赖人工管理，运维人员需要定期执行索引创建、分片调整、数据迁移、过期删除等操作，不仅耗时费力，还容易因人为疏忽导致数据冗余或误删。</p> <p><strong>索引生命周期管理（Index Lifecycle Management，ILM）</strong> 正是为解决这一问题而生——它能根据预设策略，自动化完成索引从创建到删除的全生命周期操作，大幅降低运维成本，确保集群高效稳定运行。</p> <h2 id="一、什么是ilm"><a href="#一、什么是ilm" class="header-anchor">#</a> 一、什么是ILM？</h2> <p>ILM 是 ES 提供的核心运维工具，通过<strong>策略定义</strong>和<strong>阶段流转</strong>，实现索引的自动化管理。其核心目标是：</p> <ul><li>降低热数据（高频读写）的资源占用</li> <li>优化温数据（低频查询、不写入）的存储效率</li> <li>缩减冷数据（极少查询）的存储成本</li> <li>自动清理过期无用数据</li></ul> <h2 id="二、ilm生命周期阶段详解"><a href="#二、ilm生命周期阶段详解" class="header-anchor">#</a> 二、ILM生命周期阶段详解</h2> <p>索引的生命周期可划分为 4 个核心阶段（默认按时间流转，也可按条件触发），每个阶段可配置停留时间和执行操作。</p> <table><thead><tr><th>阶段</th> <th>数据特征</th> <th>适用场景</th> <th>典型操作及作用</th></tr></thead> <tbody><tr><td><strong>hot</strong>（热阶段）</td> <td>高频写入、高频查询</td> <td>近7天的日志、实时监控数据</td> <td>滚动更新（rollover）：当索引达到指定大小/文档数/时间后，自动创建新索引承接写入，避免单索引过大</td></tr> <tr><td><strong>warm</strong>（温阶段）</td> <td>停止写入、低频查询</td> <td>7~30天的历史日志</td> <td>1. 收缩分片（shrink）：将多分片收缩为1个，减少资源占用<br>2. 合并分段（forcemerge）：将多个分段合并为1个，优化查询性能</td></tr> <tr><td><strong>cold</strong>（冷阶段）</td> <td>极少查询、长期保留</td> <td>30~180天的归档数据</td> <td>1. 迁移到冷节点（使用低成本存储介质）<br>2. 降低副本数（减少冗余存储）</td></tr> <tr><td><strong>delete</strong>（删除阶段）</td> <td>过期无用、无需保留</td> <td>180天以上的过期数据</td> <td>自动删除：释放集群存储资源</td></tr></tbody></table> <h2 id="三、ilm策略-定义索引的-生命周期规则"><a href="#三、ilm策略-定义索引的-生命周期规则" class="header-anchor">#</a> 三、ILM策略：定义索引的&quot;生命周期规则&quot;</h2> <p>ILM 策略是索引生命周期管理的核心配置，用于定义索引在每个阶段的行为（何时进入阶段、执行哪些操作）。策略需结合业务场景定制，例如：</p> <ul><li>日志类索引：热阶段保留7天（滚动更新）→ 温阶段保留23天（总30天，收缩+合并）→ 冷阶段保留150天（总180天）→ 删除</li> <li>监控数据索引：热阶段保留1天 → 温阶段保留6天（总7天）→ 删除</li></ul> <h2 id="四、实战-配置日志索引的ilm全流程"><a href="#四、实战-配置日志索引的ilm全流程" class="header-anchor">#</a> 四、实战：配置日志索引的ILM全流程</h2> <p>以&quot;java应用日志&quot;为例，演示如何配置ILM策略，实现日志索引的自动化管理。</p> <h3 id="步骤1-创建ilm策略"><a href="#步骤1-创建ilm策略" class="header-anchor">#</a> 步骤1：创建ILM策略</h3> <p>定义日志索引的生命周期规则，包含热、温、删除三个阶段（根据需求可增加冷阶段）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>PUT _ilm/policy/java-logs-rollover-policy
{
  &quot;policy&quot;: {
    &quot;phases&quot;: {
      &quot;hot&quot;: {
        &quot;min_age&quot;: &quot;0ms&quot;,  // 索引创建后立即进入热阶段
        &quot;actions&quot;: {
          // 滚动更新：当索引满足任一条件时，创建新索引
          &quot;rollover&quot;: {
            &quot;max_size&quot;: &quot;50gb&quot;,  // 索引达到50GB时滚动（生产环境建议50~100GB）
            &quot;max_docs&quot;: 10000000,  // 文档数达到1000万时滚动
            &quot;max_age&quot;: &quot;1d&quot;  // 存在超过1天时滚动（按天切割日志）
          },
          &quot;set_priority&quot;: { &quot;priority&quot;: 100 }  // 热阶段优先级最高（资源调度优先）
        }
      },
      &quot;warm&quot;: {
        &quot;min_age&quot;: &quot;7d&quot;,  // 热阶段结束后，停留7天进入温阶段（总保留7天）
        &quot;actions&quot;: {
          &quot;shrink&quot;: { 
            &quot;number_of_shards&quot;: 1  // 收缩为1个分片（热阶段可能为3分片，减少资源占用）
          },
          &quot;forcemerge&quot;: {  
            &quot;max_num_segments&quot;: 1  // 合并为1个分段（减少文件句柄占用，优化查询）
          },
          &quot;set_priority&quot;: { &quot;priority&quot;: 50 }  // 温阶段优先级降低
        }
      },
      &quot;delete&quot;: {
        &quot;min_age&quot;: &quot;180d&quot;,  // 从创建到现在满180天进入删除阶段
        &quot;actions&quot;: { &quot;delete&quot;: {} }  // 自动删除索引
      }
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p><strong>关键参数说明</strong>：</p> <ul><li><code>min_age</code>：进入当前阶段的最小时间（从索引创建时间开始计算）</li> <li><code>rollover</code>：热阶段核心操作，需配合&quot;滚动别名&quot;使用（见步骤3）</li> <li><code>shrink</code>：收缩分片前需确保索引只读（ILM会自动处理），且分片数需为目标分片数的倍数</li></ul> <h3 id="步骤2-创建索引模板-关联ilm策略"><a href="#步骤2-创建索引模板-关联ilm策略" class="header-anchor">#</a> 步骤2：创建索引模板，关联ILM策略</h3> <p>通过索引模板，让所有符合规则的新索引自动应用ILM策略（无需手动配置）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>PUT _index_template/java-logs-rollover-template
{
  &quot;index_patterns&quot;: [&quot;java-logs-*&quot;],  // 匹配所有以&quot;java-logs-&quot;开头的索引
  &quot;template&quot;: {
    &quot;settings&quot;: {
      &quot;number_of_shards&quot;: 3,  // 热阶段分片数（根据写入量调整）
      &quot;number_of_replicas&quot;: 1,  // 副本数（保证高可用）
      &quot;index.lifecycle.name&quot;: &quot;java-logs-rollover-policy&quot;,  // 关联ILM策略
      &quot;index.lifecycle.rollover_alias&quot;: &quot;java-logs-current&quot;  // 滚动别名（固定写入入口）
    },
    &quot;mappings&quot;: {  // 可按需定义日志字段映射（例如时间戳、日志级别等）
      &quot;properties&quot;: {
        &quot;@timestamp&quot;: { &quot;type&quot;: &quot;date&quot; },
        &quot;level&quot;: { &quot;type&quot;: &quot;keyword&quot; },
        &quot;message&quot;: { &quot;type&quot;: &quot;text&quot; }
      }
    }
  },
  &quot;priority&quot;: 200,  // 模板优先级（数值越高越优先，避免被其他模板覆盖）
  &quot;version&quot;: 1,
  &quot;_meta&quot;: { &quot;description&quot;: &quot;java日志索引模板，自动关联ILM策略&quot; }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>模板作用</strong>：当创建<code>java-logs-000002</code>、<code>java-logs-000003</code>等索引时，会自动继承模板中的分片配置、ILM策略关联等设置。</p> <h3 id="步骤3-初始化索引并绑定滚动别名"><a href="#步骤3-初始化索引并绑定滚动别名" class="header-anchor">#</a> 步骤3：初始化索引并绑定滚动别名</h3> <p>使用<code>rollover</code>操作需初始化一个&quot;基础索引&quot;，并绑定滚动别名（作为固定写入入口）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 创建初始索引（名称必须包含数字后缀，如-000001，用于rollover递增）
PUT java-logs-000001
{
  &quot;aliases&quot;: {
    &quot;java-logs-current&quot;: {
      &quot;is_write_index&quot;: true  // 标记为当前可写入索引（rollover后会自动切换）
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>工作原理</strong>：</p> <ul><li>写入端始终向<code>java-logs-current</code>别名写入数据</li> <li>当<code>java-logs-000001</code>满足rollover条件时，ILM自动创建<code>java-logs-000002</code>，并将<code>java-logs-current</code>的写入权限切换到新索引</li> <li>旧索引<code>java-logs-000001</code>则按策略进入后续阶段</li></ul> <h3 id="步骤4-调整ilm扫描频率-可选"><a href="#步骤4-调整ilm扫描频率-可选" class="header-anchor">#</a> 步骤4：调整ILM扫描频率（可选）</h3> <p>ILM默认每10分钟扫描一次索引，检查是否需要执行策略动作。可根据需求调整扫描间隔（生产环境建议保留默认，测试可缩短）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>PUT _cluster/settings
{
  &quot;transient&quot;: {  // 临时调整（集群重启后失效）
    &quot;indices.lifecycle.poll_interval&quot;: &quot;10s&quot;  // 每10秒扫描一次（测试用）
  }
}

# 永久调整（需重启集群生效）
PUT _cluster/settings
{
  &quot;persistent&quot;: {
    &quot;indices.lifecycle.poll_interval&quot;: &quot;1m&quot;  // 每1分钟扫描一次
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="步骤5-验证ilm配置"><a href="#步骤5-验证ilm配置" class="header-anchor">#</a> 步骤5：验证ILM配置</h3> <p>通过以下API确认配置是否生效：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 1. 查看ILM策略详情
GET _ilm/policy/java-logs-rollover-policy

# 2. 查看索引模板详情
GET _index_template/java-logs-rollover-template

# 3. 查看索引的ILM状态（当前阶段、下一步动作等）
GET java-logs-000001/_ilm/explain

# 4. 查看索引别名绑定情况
GET java-logs-current  # 应返回当前写入索引（如java-logs-000001）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="五、ilm执行机制与注意事项"><a href="#五、ilm执行机制与注意事项" class="header-anchor">#</a> 五、ILM执行机制与注意事项</h2> <h3 id="执行流程"><a href="#执行流程" class="header-anchor">#</a> 执行流程</h3> <ol><li>ILM按<code>poll_interval</code>频率扫描所有关联策略的索引</li> <li>检查索引是否满足当前阶段的<code>min_age</code>和动作触发条件</li> <li>若满足条件，执行阶段定义的动作（如rollover、shrink）</li> <li>动作执行完成后，索引进入下一阶段</li></ol> <h3 id="注意事项"><a href="#注意事项" class="header-anchor">#</a> 注意事项</h3> <ol><li><strong>索引名称规则</strong>：使用<code>rollover</code>时，索引名称必须以数字后缀结尾（如<code>xxx-000001</code>），否则无法自动递增</li> <li><strong>收缩分片前提</strong>：<code>shrink</code>操作要求索引所有主分片必须在同一个节点，且副本数需临时调整为0（ILM会自动处理，但需确保节点有足够空间）</li> <li><strong>forcemerge影响</strong>：合并分段会消耗大量IO资源，建议在业务低峰期执行（可通过<code>min_age</code>控制时间）</li> <li><strong>策略更新</strong>：修改ILM策略后，已存在的索引会自动应用新策略（无需重新关联）</li></ol> <h2 id="六、常见问题排查"><a href="#六、常见问题排查" class="header-anchor">#</a> 六、常见问题排查</h2> <ol><li><p><strong>策略不生效？</strong></p> <ul><li>检查索引是否匹配模板的<code>index_patterns</code></li> <li>确认索引<code>settings</code>中是否正确关联<code>index.lifecycle.name</code></li> <li>查看ILM扫描日志：<code>GET _cluster/allocation/explain</code> 或 ES集群日志</li></ul></li> <li><p><strong>rollover未触发？</strong></p> <ul><li>检查索引名称是否包含数字后缀</li> <li>确认<code>rollover_alias</code>绑定正确，且<code>is_write_index: true</code></li> <li>验证<code>max_size</code>/<code>max_docs</code>/<code>max_age</code>条件是否满足（<code>GET java-logs-000001/_stats</code>查看索引信息）</li></ul></li> <li><p><strong>shrink失败？</strong></p> <ul><li>检查索引是否已停止写入（热阶段已结束）</li> <li>确认主分片是否都在同一个节点（<code>GET _cat/shards/java-logs-000001</code>）</li></ul></li></ol> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>ILM 通过自动化索引生命周期管理，解决了时序数据在 ES 中的存储和运维难题。合理配置热、温、冷、删除阶段的策略，既能保证热数据的读写性能，又能降低历史数据的存储成本。</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/tavio-zhang/blog/edit/master/docs/《Elasticsearch》笔记/7. ES ILM.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=ES%20ILM" title="标签">#ES ILM</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2026/01/21, 19:29:14</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/af50b1/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">ELK的底层逻辑</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/af50b1/" class="prev">ELK的底层逻辑</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/942d4b/"><div>
            订单超时取消
            <!----></div></a> <span class="date">01-21</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/87b303/"><div>
            双 Token 登录
            <!----></div></a> <span class="date">01-21</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/a3f3fd/"><div>
            长短链接跳转
            <!----></div></a> <span class="date">01-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:taviozhang@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/tavio-zhang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.c6ba13aa.js" defer></script><script src="/assets/js/2.8d9f533d.js" defer></script><script src="/assets/js/42.575e5238.js" defer></script>
  </body>
</html>
