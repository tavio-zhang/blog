<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ClickHouse建表避坑 | Tavio&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/logo.jpg">
    <meta name="description" content="后端技术博客,别让自己落后于技术的迭代">
    <meta name="keywords" content="鲜衣努码少年郎">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.3d594d45.css" as="style"><link rel="preload" href="/assets/js/app.c6ba13aa.js" as="script"><link rel="preload" href="/assets/js/2.8d9f533d.js" as="script"><link rel="preload" href="/assets/js/35.5777ff14.js" as="script"><link rel="prefetch" href="/assets/js/10.3c6e6522.js"><link rel="prefetch" href="/assets/js/11.09bc43b4.js"><link rel="prefetch" href="/assets/js/12.a996a87c.js"><link rel="prefetch" href="/assets/js/13.b02d3acf.js"><link rel="prefetch" href="/assets/js/14.64fd6e84.js"><link rel="prefetch" href="/assets/js/15.089c02a9.js"><link rel="prefetch" href="/assets/js/16.8fa236f4.js"><link rel="prefetch" href="/assets/js/17.a1730b7a.js"><link rel="prefetch" href="/assets/js/18.1335a425.js"><link rel="prefetch" href="/assets/js/19.9293cbc0.js"><link rel="prefetch" href="/assets/js/20.5d0fd1df.js"><link rel="prefetch" href="/assets/js/21.4319dddd.js"><link rel="prefetch" href="/assets/js/22.2d6d1193.js"><link rel="prefetch" href="/assets/js/23.f154e330.js"><link rel="prefetch" href="/assets/js/24.66ba0133.js"><link rel="prefetch" href="/assets/js/25.5979047a.js"><link rel="prefetch" href="/assets/js/26.04889c33.js"><link rel="prefetch" href="/assets/js/27.337928e8.js"><link rel="prefetch" href="/assets/js/28.665066df.js"><link rel="prefetch" href="/assets/js/29.5aa838b8.js"><link rel="prefetch" href="/assets/js/3.1aac6e80.js"><link rel="prefetch" href="/assets/js/30.a8923cf6.js"><link rel="prefetch" href="/assets/js/31.a290d548.js"><link rel="prefetch" href="/assets/js/32.cb2b7fdd.js"><link rel="prefetch" href="/assets/js/33.3286dca2.js"><link rel="prefetch" href="/assets/js/34.9aebb473.js"><link rel="prefetch" href="/assets/js/36.5c29dd6e.js"><link rel="prefetch" href="/assets/js/37.cbf6fde7.js"><link rel="prefetch" href="/assets/js/38.2a1572ab.js"><link rel="prefetch" href="/assets/js/39.000aacf6.js"><link rel="prefetch" href="/assets/js/4.16da1e3f.js"><link rel="prefetch" href="/assets/js/40.8fbbcfa8.js"><link rel="prefetch" href="/assets/js/41.1b995757.js"><link rel="prefetch" href="/assets/js/42.575e5238.js"><link rel="prefetch" href="/assets/js/43.0a4cb54f.js"><link rel="prefetch" href="/assets/js/44.8d3b4283.js"><link rel="prefetch" href="/assets/js/45.ae001bba.js"><link rel="prefetch" href="/assets/js/46.fc29dcb1.js"><link rel="prefetch" href="/assets/js/47.628ee1ef.js"><link rel="prefetch" href="/assets/js/48.7d4f854a.js"><link rel="prefetch" href="/assets/js/49.e848253a.js"><link rel="prefetch" href="/assets/js/5.20e9c2cf.js"><link rel="prefetch" href="/assets/js/50.045225be.js"><link rel="prefetch" href="/assets/js/51.d05a2035.js"><link rel="prefetch" href="/assets/js/52.35a2519d.js"><link rel="prefetch" href="/assets/js/53.ca8d5bc8.js"><link rel="prefetch" href="/assets/js/54.eb93e6ae.js"><link rel="prefetch" href="/assets/js/55.27ff3cca.js"><link rel="prefetch" href="/assets/js/56.4a98635a.js"><link rel="prefetch" href="/assets/js/57.db243c6d.js"><link rel="prefetch" href="/assets/js/58.650ffef2.js"><link rel="prefetch" href="/assets/js/59.9af578d0.js"><link rel="prefetch" href="/assets/js/6.cf5ce51d.js"><link rel="prefetch" href="/assets/js/60.800afb74.js"><link rel="prefetch" href="/assets/js/61.59b23cca.js"><link rel="prefetch" href="/assets/js/62.35998712.js"><link rel="prefetch" href="/assets/js/63.824df362.js"><link rel="prefetch" href="/assets/js/64.2f51e9d0.js"><link rel="prefetch" href="/assets/js/65.926e2499.js"><link rel="prefetch" href="/assets/js/66.2af85da2.js"><link rel="prefetch" href="/assets/js/67.bbd8d4b3.js"><link rel="prefetch" href="/assets/js/68.163c774f.js"><link rel="prefetch" href="/assets/js/69.deed8d29.js"><link rel="prefetch" href="/assets/js/7.92776da2.js"><link rel="prefetch" href="/assets/js/70.d6a81068.js"><link rel="prefetch" href="/assets/js/71.9adb8c50.js"><link rel="prefetch" href="/assets/js/72.9ba26fc5.js"><link rel="prefetch" href="/assets/js/73.c3ee5d2f.js"><link rel="prefetch" href="/assets/js/74.af7973c7.js"><link rel="prefetch" href="/assets/js/75.ed8e7990.js"><link rel="prefetch" href="/assets/js/76.668519a5.js"><link rel="prefetch" href="/assets/js/77.d6cb2694.js"><link rel="prefetch" href="/assets/js/78.494cff39.js"><link rel="prefetch" href="/assets/js/79.486534af.js"><link rel="prefetch" href="/assets/js/8.d7fc67a9.js"><link rel="prefetch" href="/assets/js/80.c60f84eb.js"><link rel="prefetch" href="/assets/js/81.80ab610c.js"><link rel="prefetch" href="/assets/js/82.38a483d0.js"><link rel="prefetch" href="/assets/js/83.72b7d6a4.js"><link rel="prefetch" href="/assets/js/84.f5a347be.js"><link rel="prefetch" href="/assets/js/85.f3b7b32b.js"><link rel="prefetch" href="/assets/js/86.1d47bd30.js"><link rel="prefetch" href="/assets/js/87.2361eddb.js"><link rel="prefetch" href="/assets/js/88.aef9e475.js"><link rel="prefetch" href="/assets/js/89.0a95e3be.js"><link rel="prefetch" href="/assets/js/9.f6c9df9a.js"><link rel="prefetch" href="/assets/js/90.ddf7b632.js"><link rel="prefetch" href="/assets/js/91.2a96bacf.js"><link rel="prefetch" href="/assets/js/92.f61fc5ec.js"><link rel="prefetch" href="/assets/js/93.40a17799.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3d594d45.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="Tavio's blog" class="logo"> <span class="site-name can-hide">Tavio's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/jvm/" class="nav-link">JVM底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/thread/" class="nav-link">邪恶多线程</a></li><li class="dropdown-item"><!----> <a href="/node/mybatis/" class="nav-link">MyBatis底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/spring/" class="nav-link">Spring底层原理</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/db/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/mysql/" class="nav-link">MySQL的优化之路</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">ClickHouse的高性能</a></li><li class="dropdown-item"><!----> <a href="/note/redis/" class="nav-link">Redis的快速查询</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/middleware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/rabbitmq/" class="nav-link">RabbitMQ的生产</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">Kafka的高吞吐量</a></li><li class="dropdown-item"><!----> <a href="/note/es/" class="nav-link">ES的入门到入坑</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实践" class="dropdown-title"><a href="/practice/" class="link-title">实践</a> <span class="title" style="display:none;">实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/284351/" class="nav-link">MySQL自增ID主键空洞</a></li><li class="dropdown-item"><!----> <a href="/pages/8f1df0/" class="nav-link">前端实现长整型排序</a></li><li class="dropdown-item"><!----> <a href="/pages/13fcc3/" class="nav-link">MySQL无感换表</a></li><li class="dropdown-item"><!----> <a href="/pages/69e163/" class="nav-link">Redis延时双删</a></li><li class="dropdown-item"><!----> <a href="/pages/f43494/" class="nav-link">高并发秒杀优惠卷</a></li><li class="dropdown-item"><!----> <a href="/pages/ab9a49/" class="nav-link">AOP无侵入式告警</a></li><li class="dropdown-item"><!----> <a href="/pages/a3f3fd/" class="nav-link">长短链接跳转</a></li><li class="dropdown-item"><!----> <a href="/pages/942d4b/" class="nav-link">订单超时取消</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/tavio-zhang/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.jpg"> <div class="blogger-info"><h3>Tavio Zhang</h3> <span>努力学习的小码喽</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/jvm/" class="nav-link">JVM底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/thread/" class="nav-link">邪恶多线程</a></li><li class="dropdown-item"><!----> <a href="/node/mybatis/" class="nav-link">MyBatis底层原理</a></li><li class="dropdown-item"><!----> <a href="/node/spring/" class="nav-link">Spring底层原理</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/db/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/mysql/" class="nav-link">MySQL的优化之路</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">ClickHouse的高性能</a></li><li class="dropdown-item"><!----> <a href="/note/redis/" class="nav-link">Redis的快速查询</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/middleware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/rabbitmq/" class="nav-link">RabbitMQ的生产</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">Kafka的高吞吐量</a></li><li class="dropdown-item"><!----> <a href="/note/es/" class="nav-link">ES的入门到入坑</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实践" class="dropdown-title"><a href="/practice/" class="link-title">实践</a> <span class="title" style="display:none;">实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/284351/" class="nav-link">MySQL自增ID主键空洞</a></li><li class="dropdown-item"><!----> <a href="/pages/8f1df0/" class="nav-link">前端实现长整型排序</a></li><li class="dropdown-item"><!----> <a href="/pages/13fcc3/" class="nav-link">MySQL无感换表</a></li><li class="dropdown-item"><!----> <a href="/pages/69e163/" class="nav-link">Redis延时双删</a></li><li class="dropdown-item"><!----> <a href="/pages/f43494/" class="nav-link">高并发秒杀优惠卷</a></li><li class="dropdown-item"><!----> <a href="/pages/ab9a49/" class="nav-link">AOP无侵入式告警</a></li><li class="dropdown-item"><!----> <a href="/pages/a3f3fd/" class="nav-link">长短链接跳转</a></li><li class="dropdown-item"><!----> <a href="/pages/942d4b/" class="nav-link">订单超时取消</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/tavio-zhang/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/d1c3a5/" class="sidebar-link">ClickHouse性能怪兽</a></li><li><a href="/pages/547ec1/" class="sidebar-link">ClickHouse核心引擎家族</a></li><li><a href="/pages/ed208a/" aria-current="page" class="active sidebar-link">ClickHouse建表避坑</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/ed208a/#一、先厘清-三个-键-的核心作用与本质区别" class="sidebar-link">一、先厘清：三个“键”的核心作用与本质区别</a></li><li class="sidebar-sub-header level2"><a href="/pages/ed208a/#二、分区键-粒度是关键-别太细也别太粗" class="sidebar-link">二、分区键：粒度是关键，别太细也别太粗</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_1-选择原则-按-时间-业务维度-组合-控制单分区大小" class="sidebar-link">1. 选择原则：按“时间+业务维度”组合，控制单分区大小</a></li><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_2-避坑指南-这3个错误千万别犯" class="sidebar-link">2. 避坑指南：这3个错误千万别犯</a></li><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_3-实战案例-不同数据量的分区键选择" class="sidebar-link">3. 实战案例：不同数据量的分区键选择</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ed208a/#三、排序键-查询导向设计-把-高频过滤字段-放前面" class="sidebar-link">三、排序键：查询导向设计，把“高频过滤字段”放前面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_1-选择原则-高频字段优先-前缀匹配优先" class="sidebar-link">1. 选择原则：高频字段优先，前缀匹配优先</a></li><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_2-避坑指南-这4个误区要避开" class="sidebar-link">2. 避坑指南：这4个误区要避开</a></li><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_3-实战案例-不同查询场景的排序键设计" class="sidebar-link">3. 实战案例：不同查询场景的排序键设计</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ed208a/#四、主键-默认前缀即可-别当-唯一约束-用" class="sidebar-link">四、主键：默认前缀即可，别当“唯一约束”用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_1-选择原则-简化优先-复用排序键前缀" class="sidebar-link">1. 选择原则：简化优先，复用排序键前缀</a></li><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_2-避坑指南-这2个错误最致命" class="sidebar-link">2. 避坑指南：这2个错误最致命</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ed208a/#五、三者协同设计-实战建表案例拆解" class="sidebar-link">五、三者协同设计：实战建表案例拆解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_1-场景1-电商订单表-mergetree-引擎" class="sidebar-link">1. 场景1：电商订单表（MergeTree 引擎）</a></li><li class="sidebar-sub-header level3"><a href="/pages/ed208a/#_2-场景2-用户行为日志表-replicatedmergetree-引擎-高可用" class="sidebar-link">2. 场景2：用户行为日志表（ReplicatedMergeTree 引擎，高可用）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ed208a/#六、总结-建表避坑核心口诀" class="sidebar-link">六、总结：建表避坑核心口诀</a></li></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/note/clickhouse/#《ClickHouse》笔记" data-v-06225672>《ClickHouse》笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/tavio-zhang" target="_blank" title="作者" class="beLink" data-v-06225672>Tavio</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-06-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">ClickHouse建表避坑<!----></h1>  <div class="theme-vdoing-content content__default"><p>在 ClickHouse 中，建表是整个数据架构的基石，而分区键（PARTITION BY）、排序键（ORDER BY）、主键（PRIMARY KEY）的设计，直接决定了后续查询性能、存储效率和运维成本。很多初学者甚至资深开发者，都会在这三个“键”的选择上踩坑——比如把主键当唯一约束用、分区键粒度太细导致元数据爆炸、排序键设计不合理让查询全表扫描。</p> <h2 id="一、先厘清-三个-键-的核心作用与本质区别"><a href="#一、先厘清-三个-键-的核心作用与本质区别" class="header-anchor">#</a> 一、先厘清：三个“键”的核心作用与本质区别</h2> <p>首先要明确：ClickHouse 的分区键、排序键、主键，和 MySQL、PostgreSQL 等传统关系型数据库的概念完全不同，切勿直接套用经验。三者的核心定位和作用如下：</p> <table><thead><tr><th>参数</th> <th>核心作用</th> <th>本质特征</th> <th>关键影响</th></tr></thead> <tbody><tr><td>分区键（PARTITION BY）</td> <td>数据分片存储，实现“分区裁剪”</td> <td>逻辑上的数据集划分，按分区独立管理数据（可独立删除、TTL）</td> <td>查询时能否快速过滤无效数据；元数据管理成本</td></tr> <tr><td>排序键（ORDER BY）</td> <td>决定数据在磁盘上的物理存储顺序</td> <td>数据按排序键有序存储，支撑稀疏索引和查询跳过</td> <td>查询扫描范围大小；数据压缩率；合并（Merge）效率</td></tr> <tr><td>主键（PRIMARY KEY）</td> <td>构建稀疏索引，快速定位数据块</td> <td>默认是排序键的前缀（可自定义），非唯一约束，仅用于索引定位</td> <td>数据定位速度；索引存储开销</td></tr></tbody></table> <p>核心结论：<strong>分区键负责“大范围数据过滤”，排序键负责“小范围数据有序与跳过”，主键是排序键的“索引入口”</strong>。三者协同决定了查询性能的上限。</p> <h2 id="二、分区键-粒度是关键-别太细也别太粗"><a href="#二、分区键-粒度是关键-别太细也别太粗" class="header-anchor">#</a> 二、分区键：粒度是关键，别太细也别太粗</h2> <p>分区键的核心价值是“分区裁剪”——查询时如果带上分区键条件，ClickHouse 会直接跳过不相关的分区，只扫描目标分区数据，大幅减少I/O开销。但分区键的粒度设计是重中之重，过细或过粗都会踩坑。</p> <h3 id="_1-选择原则-按-时间-业务维度-组合-控制单分区大小"><a href="#_1-选择原则-按-时间-业务维度-组合-控制单分区大小" class="header-anchor">#</a> 1. 选择原则：按“时间+业务维度”组合，控制单分区大小</h3> <p>最通用、最安全的选择是 <strong>“时间字段为主，业务维度为辅”</strong>，同时满足“单分区大小10-100GB”“分区数量不超过1000”两个核心指标（ClickHouse 对元数据的管理效率在1000个分区以内最优）。</p> <p>常见选择优先级：</p> <ol><li>高频场景：按日期/月份分区（适用于日志、监控、行为等时间序列数据）
示例：<code>PARTITION BY toYYYYMMDD(event_time)</code>（按天）、<code>PARTITION BY toYYYYMM(event_time)</code>（按月）</li> <li>低频场景：按业务维度+时间分区（适用于数据量较小的业务表）
示例：<code>PARTITION BY (business_line, toYYYYMM(event_time))</code>（业务线+月）</li> <li>特殊场景：固定分区（适用于小表、配置表）
示例：<code>PARTITION BY 1</code>（所有数据在一个分区）</li></ol> <h3 id="_2-避坑指南-这3个错误千万别犯"><a href="#_2-避坑指南-这3个错误千万别犯" class="header-anchor">#</a> 2. 避坑指南：这3个错误千万别犯</h3> <ul><li><strong>坑1：分区粒度太细（如按小时分区）</strong>
后果：如果数据量较大，会导致分区数量暴增（一天24个分区，一年8760个），元数据管理压力大，合并（Merge）线程忙不过来，查询时扫描大量小分区反而变慢。
避坑：只有当单小时数据量达到10GB以上，且查询需要按小时过滤时，才考虑按小时分区；否则优先按天/月。</li> <li><strong>坑2：分区粒度太粗（如按年分区）</strong>
后果：单分区数据量过大（可能达TB级），查询时无法有效裁剪，相当于全表扫描；且删除过期数据时（如删除1年前数据），单分区删除耗时久，影响集群性能。
避坑：单分区大小超过100GB时，必须细化粒度（比如从按年改为按月）。</li> <li><strong>坑3：用高频离散字段当分区键（如user_id、device_id）</strong>
后果：每个分区只有少量数据（甚至单行），分区数量爆炸，元数据崩溃，查询性能极差。
避坑：绝对禁止用高频离散字段单独当分区键；若需按用户维度过滤，优先放在排序键中。</li></ul> <h3 id="_3-实战案例-不同数据量的分区键选择"><a href="#_3-实战案例-不同数据量的分区键选择" class="header-anchor">#</a> 3. 实战案例：不同数据量的分区键选择</h3> <ul><li>案例1：用户行为日志（日均100GB）
选择：<code>PARTITION BY toYYYYMMDD(event_time)</code>（按天分区，单分区100GB左右，一年365个分区，符合要求）</li> <li>案例2：设备监控数据（日均5GB）
选择：<code>PARTITION BY toYYYYMM(event_time)</code>（按月分区，单分区150GB左右，一年12个分区，管理成本低）</li> <li>案例3：业务配置表（总数据10MB）
选择：<code>PARTITION BY 1</code>（单分区，无需裁剪，简化管理）</li></ul> <h2 id="三、排序键-查询导向设计-把-高频过滤字段-放前面"><a href="#三、排序键-查询导向设计-把-高频过滤字段-放前面" class="header-anchor">#</a> 三、排序键：查询导向设计，把“高频过滤字段”放前面</h2> <p>排序键是 ClickHouse 性能优化的核心——数据按排序键物理有序存储，一方面能提升压缩率（有序数据压缩比更高），另一方面能支撑“稀疏索引跳过”：查询时通过排序键的索引标记，直接跳过不满足条件的数据块，减少扫描范围。</p> <p>关键原则：<strong>排序键的设计必须“以查询为导向”，把高频过滤、分组、排序字段放在前面</strong>，且字段数量不宜过多（建议不超过4个，过多会降低索引效率）。</p> <h3 id="_1-选择原则-高频字段优先-前缀匹配优先"><a href="#_1-选择原则-高频字段优先-前缀匹配优先" class="header-anchor">#</a> 1. 选择原则：高频字段优先，前缀匹配优先</h3> <p>ClickHouse 的查询优化器对排序键的“前缀匹配”支持最好，因此排序键的字段顺序优先级为：</p> <ol><li>第一优先级：查询中最常用的 <code>WHERE</code> 过滤字段（如 user_id、order_id、status）</li> <li>第二优先级：查询中常用的 <code>GROUP BY</code> 分组字段（如 business_line、region）</li> <li>第三优先级：查询中常用的 <code>ORDER BY</code> 排序字段（如 event_time、amount）</li></ol> <p>示例：某电商订单表，高频查询场景是“按用户ID查询订单”“按订单状态+时间统计”，排序键设计为：
<code>ORDER BY (user_id, status, create_time)</code></p> <h3 id="_2-避坑指南-这4个误区要避开"><a href="#_2-避坑指南-这4个误区要避开" class="header-anchor">#</a> 2. 避坑指南：这4个误区要避开</h3> <ul><li><strong>坑1：排序键字段过多（如5个以上）</strong>
后果：稀疏索引的粒度变粗，跳过效率降低；同时增加数据合并时的排序开销，影响写入性能。
避坑：只保留前3-4个高频字段，低频字段不放入排序键。</li> <li><strong>坑2：排序键与查询过滤字段不匹配</strong>
后果：查询无法利用排序键的跳过功能，只能全分区扫描，性能极差。
示例：排序键是 <code>(create_time, user_id)</code>，但高频查询是 <code>WHERE user_id = 123</code>（非前缀字段），无法触发跳过。
避坑：调整排序键顺序为 <code>(user_id, create_time)</code>，确保高频过滤字段在排序键前缀。</li> <li><strong>坑3：把低基数字段放前面</strong>
后果：低基数字段（如 status，只有“待支付”“已支付”等几个值）的区分度低，排序后数据分布集中，跳过效率差。
避坑：高基数字段（如 user_id、order_id）优先放在排序键前面，低基数字段放后面。</li> <li><strong>坑4：忽略数据压缩率</strong>
后果：无序数据或低重复度数据的压缩比极低，增加存储成本。
避坑：时间字段、枚举字段等重复度高的字段，可适当放在排序键中，提升压缩率（如 create_time 放在高基数字段之后）。</li></ul> <h3 id="_3-实战案例-不同查询场景的排序键设计"><a href="#_3-实战案例-不同查询场景的排序键设计" class="header-anchor">#</a> 3. 实战案例：不同查询场景的排序键设计</h3> <ul><li>场景1：用户行为日志（高频查询：按用户ID+日期过滤）
排序键：<code>ORDER BY (user_id, event_time)</code>（高基数user_id在前，时间字段在后，兼顾过滤和压缩）</li> <li>场景2：商品销售统计（高频查询：按商品ID+销售日期分组）
排序键：<code>ORDER BY (product_id, sale_date)</code>（商品ID过滤，销售日期分组，匹配查询逻辑）</li> <li>场景3：实时监控指标（高频查询：按指标类型+时间排序）
排序键：<code>ORDER BY (metric_type, collect_time)</code>（指标类型过滤，时间排序，提升查询跳过效率）</li></ul> <h2 id="四、主键-默认前缀即可-别当-唯一约束-用"><a href="#四、主键-默认前缀即可-别当-唯一约束-用" class="header-anchor">#</a> 四、主键：默认前缀即可，别当“唯一约束”用</h2> <p>ClickHouse 的主键和传统数据库的主键完全不同——它不具备“唯一约束”功能，仅用于构建“稀疏索引”，帮助快速定位数据块。默认情况下，主键是排序键的前缀（如果不指定主键，主键=排序键）。</p> <h3 id="_1-选择原则-简化优先-复用排序键前缀"><a href="#_1-选择原则-简化优先-复用排序键前缀" class="header-anchor">#</a> 1. 选择原则：简化优先，复用排序键前缀</h3> <p>大多数场景下，<strong>无需手动指定主键</strong>，直接使用默认值（主键=排序键）即可。只有当排序键字段较多，且高频查询仅依赖前1-2个字段时，才需要手动指定主键（取排序键的前缀），减少索引存储开销。</p> <p>示例：排序键是 <code>(user_id, status, create_time)</code>，高频查询仅依赖 <code>user_id</code> 过滤，可手动指定主键：
<code>PRIMARY KEY (user_id)</code></p> <h3 id="_2-避坑指南-这2个错误最致命"><a href="#_2-避坑指南-这2个错误最致命" class="header-anchor">#</a> 2. 避坑指南：这2个错误最致命</h3> <ul><li><strong>坑1：把主键当唯一约束用</strong>
后果：ClickHouse 不会检查主键的唯一性，插入重复主键的数据会直接存储，导致数据不一致。
避坑：如果需要去重，应使用 <code>ReplacingMergeTree</code> 引擎，通过排序键+版本列实现去重，而非依赖主键。</li> <li><strong>坑2：主键不是排序键的前缀</strong>
后果：ClickHouse 不支持主键非排序键前缀的设计，建表会直接报错。
避坑：主键必须是排序键的子集且为前缀，例如排序键是 <code>(a,b,c)</code>，主键可设为 <code>(a)</code> 或 <code>(a,b)</code>，但不能是 <code>(b,c)</code> 或 <code>(a,c)</code>。</li></ul> <h2 id="五、三者协同设计-实战建表案例拆解"><a href="#五、三者协同设计-实战建表案例拆解" class="header-anchor">#</a> 五、三者协同设计：实战建表案例拆解</h2> <p>前面讲了单个键的选择，实际建表时需要三者协同。下面以“电商订单表”和“用户行为日志表”两个典型场景，完整拆解建表语句和设计思路。</p> <h3 id="_1-场景1-电商订单表-mergetree-引擎"><a href="#_1-场景1-电商订单表-mergetree-引擎" class="header-anchor">#</a> 1. 场景1：电商订单表（MergeTree 引擎）</h3> <p>核心需求：</p> <ul><li>数据量：日均50GB，按天分区单分区50GB（符合10-100GB要求）</li> <li>高频查询：按用户ID查订单、按订单状态+日期统计、按订单ID查详情</li> <li>运维需求：保留1年数据，按月删除过期分区</li></ul> <p>建表语句：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> order_table <span class="token punctuation">(</span>
  order_id UInt64 <span class="token keyword">COMMENT</span> <span class="token string">'订单ID'</span><span class="token punctuation">,</span>
  user_id UInt64 <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
  <span class="token keyword">status</span> Enum8<span class="token punctuation">(</span><span class="token string">'pending'</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'paid'</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'shipped'</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'completed'</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'cancelled'</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单状态'</span><span class="token punctuation">,</span>
  amount Float64 <span class="token keyword">COMMENT</span> <span class="token string">'订单金额'</span><span class="token punctuation">,</span>
  create_time <span class="token keyword">DateTime</span> <span class="token keyword">COMMENT</span> <span class="token string">'创建时间'</span><span class="token punctuation">,</span>
  pay_time <span class="token keyword">DateTime</span> <span class="token keyword">COMMENT</span> <span class="token string">'支付时间'</span><span class="token punctuation">,</span>
  province String <span class="token keyword">COMMENT</span> <span class="token string">'省份'</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> MergeTree<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> toYYYYMMDD<span class="token punctuation">(</span>create_time<span class="token punctuation">)</span>  <span class="token comment">-- 按天分区（单分区50GB，一年365个分区）</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">,</span> create_time<span class="token punctuation">,</span> order_id<span class="token punctuation">)</span>  <span class="token comment">-- 排序键：高频过滤字段在前</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">)</span>  <span class="token comment">-- 主键取排序键前缀，减少索引开销</span>
TTL create_time <span class="token operator">+</span> <span class="token keyword">INTERVAL</span> <span class="token number">365</span> <span class="token keyword">DAY</span> <span class="token keyword">DELETE</span><span class="token punctuation">;</span>  <span class="token comment">-- 数据保留1年</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>设计思路：</p> <ul><li>分区键：按天分区，匹配订单数据的时间特性，便于按日期裁剪和删除过期数据；</li> <li>排序键：user_id（高频过滤）→ status（高频统计）→ create_time（时间排序）→ order_id（唯一标识），完全匹配查询场景；</li> <li>主键：仅保留user_id（高频过滤字段），减少稀疏索引的存储开销。</li></ul> <h3 id="_2-场景2-用户行为日志表-replicatedmergetree-引擎-高可用"><a href="#_2-场景2-用户行为日志表-replicatedmergetree-引擎-高可用" class="header-anchor">#</a> 2. 场景2：用户行为日志表（ReplicatedMergeTree 引擎，高可用）</h3> <p>核心需求：</p> <ul><li>数据量：日均100GB，按天分区单分区100GB；</li> <li>高频查询：按用户ID+行为类型+日期过滤，统计用户行为次数；</li> <li>运维需求：高可用（副本），保留90天数据。</li></ul> <p>建表语句：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_behavior_log <span class="token punctuation">(</span>
  user_id UInt64 <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
  behavior_type Enum8<span class="token punctuation">(</span><span class="token string">'click'</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'view'</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'purchase'</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'share'</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'行为类型'</span><span class="token punctuation">,</span>
  event_time <span class="token keyword">DateTime</span> <span class="token keyword">COMMENT</span> <span class="token string">'行为时间'</span><span class="token punctuation">,</span>
  page String <span class="token keyword">COMMENT</span> <span class="token string">'页面'</span><span class="token punctuation">,</span>
  device_id String <span class="token keyword">COMMENT</span> <span class="token string">'设备ID'</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> ReplicatedMergeTree<span class="token punctuation">(</span>
  <span class="token string">'/clickhouse/tables/{shard}/user_behavior_log'</span><span class="token punctuation">,</span>  <span class="token comment">-- ZooKeeper路径</span>
  <span class="token string">'{replica}'</span>  <span class="token comment">-- 副本标识</span>
<span class="token punctuation">)</span>
<span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> toYYYYMMDD<span class="token punctuation">(</span>event_time<span class="token punctuation">)</span>  <span class="token comment">-- 按天分区（单分区100GB，符合要求）</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> behavior_type<span class="token punctuation">,</span> event_time<span class="token punctuation">)</span>  <span class="token comment">-- 排序键：匹配高频查询过滤逻辑</span>
TTL event_time <span class="token operator">+</span> <span class="token keyword">INTERVAL</span> <span class="token number">90</span> <span class="token keyword">DAY</span> <span class="token keyword">DELETE</span><span class="token punctuation">;</span>  <span class="token comment">-- 数据保留90天</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>设计思路：</p> <ul><li>分区键：按天分区，适配日志数据的时间序列特性，便于快速裁剪；</li> <li>排序键：user_id（高频过滤）→ behavior_type（统计维度）→ event_time（时间排序），完全匹配查询场景，同时提升数据压缩率；</li> <li>主键：使用默认值（=排序键），无需额外优化，简化配置；</li> <li>引擎：ReplicatedMergeTree 保障高可用，适配生产环境需求。</li></ul> <h2 id="六、总结-建表避坑核心口诀"><a href="#六、总结-建表避坑核心口诀" class="header-anchor">#</a> 六、总结：建表避坑核心口诀</h2> <p>最后用几句口诀总结核心要点，帮你快速记忆：</p> <ol><li>分区键：时间为主，粒度适中，10-100GB/区，分区数不超千；</li> <li>排序键：查询导向，高频在前，前缀匹配，字段不超四；</li> <li>主键：默认前缀，无需冗余，不做唯一，简化优先；</li> <li>三协同：分区裁剪定范围，排序跳过缩粒度，主键索引提速度。</li></ol> <p>其实 ClickHouse 建表的核心逻辑很简单——<strong>所有设计都围绕“减少查询扫描范围”展开</strong>。只要记住“以查询为导向”，结合数据量和业务场景，就能避开大部分坑。如果建表后发现查询性能差，优先检查这三个键的设计，往往能事半功倍。</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/tavio-zhang/blog/edit/master/docs/《ClickHouse》笔记/3.ClickHouse建表避坑.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=ClickHouse%E5%BB%BA%E8%A1%A8%E9%81%BF%E5%9D%91" title="标签">#ClickHouse建表避坑</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2026/01/21, 19:29:14</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/547ec1/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">ClickHouse核心引擎家族</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/547ec1/" class="prev">ClickHouse核心引擎家族</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/942d4b/"><div>
            订单超时取消
            <!----></div></a> <span class="date">01-21</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/87b303/"><div>
            双 Token 登录
            <!----></div></a> <span class="date">01-21</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/a3f3fd/"><div>
            长短链接跳转
            <!----></div></a> <span class="date">01-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:taviozhang@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/tavio-zhang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.c6ba13aa.js" defer></script><script src="/assets/js/2.8d9f533d.js" defer></script><script src="/assets/js/35.5777ff14.js" defer></script>
  </body>
</html>
